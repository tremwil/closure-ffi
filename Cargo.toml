[workspace]
members = ["proc_macros"]

[workspace.package]
edition = "2021"
authors = ["William Tremblay <tremwil@users.noreply.github.com>"]
keywords = ["closure", "ffi"]
categories = ["development-tools::ffi", "no-std"]
license = "MIT"
repository = "https://github.com/tremwil/closure-ffi"

[package]
name = "closure-ffi"
version = "0.1.2"
description = "FFI utility for creating bare function pointers that invoke a closure"
edition.workspace = true
authors.workspace = true
keywords.workspace = true
categories.workspace = true
license.workspace = true
repository.workspace = true

[features]
default = [ "bundled_jit_alloc" ]
no_std = [ "spin" ]
bundled_jit_alloc = [ "jit-allocator" ]
hrtb_macro = [ "closure-ffi-proc-macros" ]
full = [ "bundled_jit_alloc", "hrtb_macro" ]

[dependencies]
closure-ffi-proc-macros = { path = "proc_macros", version = "0.1.1", optional = true }
jit-allocator = {version = "0.2.8", optional = true }
spin = { version = "0.9", optional = true }
seq-macro = "0.3"

[dev-dependencies]
jit-allocator = { version = "0.2.8" }
spin = { version = "0.9" }
closure-ffi = { path = ".", features = ["hrtb_macro"] }

[package.metadata.docs.rs]
features = ["full"]